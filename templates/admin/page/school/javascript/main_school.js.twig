<script type="text/javascript">
    var page_url = '/admin/test';
    var selected_rows = [];

    $(document).ready(function() {
        list.url = page_url;
        list.bindEvent();
        list.loadCurrent('select[id=cboLimit]');
        list.data.year = 2020;

        $("#subzone").change(function() {
            var id_subzone = $(this).val();
            $.ajax({
                type: "POST",
                url: page_url + "/ajax-country",
                dataType: 'json',
                data: {
                    id_subzone: id_subzone,
                },
                beforeSend: function() {
                },
                success: function(data) {
                    if (data['status'] == 1) {
                        $("#country_id").html(data['html']);
                    }
                }
            });
        });
    });

    function show_note_school(school_id) {
        if (school_id.length <= 0) {
            return false;
        }

        $.ajax({
            url: page_url + '/show-note-school',
            type: 'POST',
            dataType: 'json',
            data: { id: school_id },
            success: function(response_data) {
                if (response_data['success'] == 1) {
                    // console.log(response_data['note']);
                    $('#note-content').html($.parseHTML(response_data['note']));
                    $('#note-content').attr('data-school', school_id);
                    $('#note-school-modal').modal('show');
                }
            }
        });
    }

    function get_report(element) {
        var year_id = $(element).val();
        var year_name = $('option:selected', element).text();
        // var school_ids = new Array;
        // $('#container tr').each(function(){
        //     console.log($(this).attr('id'));
        //     school_ids.push($(this).attr('id'));
        // });

        // if (year_id.length > 0 && school_ids.length > 0)
        // {
        //     $.ajax({
        //         url: page_url + '/get-report',
        //         type: 'post',
        //         dataType: 'json',
        //         data: { year_id: year_id, year_name: year_name, school_ids: school_ids },
        //         success: function (response_data)
        //         {
        //             console.log(response_data);
        //         }
        //     });
        // }
        $('div[class*="report-"]').not('.report-' + year_name).css('display', 'none');
        $('.report-' + year_name).css('display', 'block');
    }

    function save_note_school() {
        var school_id = $('#note-content').attr('data-school');
        var note_content = $('#note-content').val();

        $.ajax({
            url: page_url + '/save-note-school',
            type: 'POST',
            dataType: 'json',
            data: { id: school_id, note: note_content },
            success: function(response) {
                if (response.success == 1) {
                    $('.note-' + school_id).html($.parseHTML(response.icon));
                    $('#note-school-modal').modal('hide');
                }
            }
        });
    }

    function copy_vote(dean_id, year) {
        $.confirm({
            title: 'Copy Vote Data!',
            content: 'Do you want to copy the previous data?',
            type: 'dark',
            buttons: {
                confirm: function() {
                    $.ajax({
                        type: "POST",
                        url: page_url + "/copy-vote",
                        dataType: 'json',
                        data: {
                            year: year,
                            dean_id: dean_id,
                        },
                        success: function(data) {
                            // console.log(data);
                            requestPage(list.data.page);
                            $.notify({
                                message: "Copy Successfully!",
                                type: 'info'
                            });
                        }
                    });
                },
                cancel: function() { }
            }
        });
    }
</script>
